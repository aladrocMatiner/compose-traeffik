# File: .env.example
#
# Environment variables for the Docker Compose stack.
# Copy this file to .env and adjust values as needed.
#
# --- General Configuration ---

# Domain name for local development.
# Used by whoami service, Traefik dashboard, and certificate generation.
# IMPORTANT: You must add an entry to your /etc/hosts file (or equivalent)
# mapping this domain to 127.0.0.1 for local resolution.
# Example: 127.0.0.1 whoami.local.test traefik.local.test step-ca.local.test
DEV_DOMAIN=local.test

# Traefik Docker image to use. Prefer a stable major version.
# Example: traefik:v3.0
TRAEFIK_IMAGE=traefik:v3.0

# Enable/Disable Traefik Dashboard. Default is false (disabled).
# If enabled, it will be available at https://traefik.<DEV_DOMAIN>
# WARNING: Do not expose publicly without proper authentication.
TRAEFIK_DASHBOARD=false

# Enable/Disable automatic HTTP to HTTPS redirection. Default is true.
# If true, all HTTP requests to configured entrypoints will be redirected to HTTPS.
HTTP_TO_HTTPS_REDIRECT=true

# --- TLS Mode A (Local Self-Signed) Configuration ---

# No specific environment variables required here, configured directly via volume mounts.

# --- TLS Mode B (Let's Encrypt with Certbot) Configuration ---

# Email for Let's Encrypt notifications (required for certbot issuance).
# Used by Traefik's ACME resolver when 'le' profile is active.
ACME_EMAIL=you@example.com

# Use Let's Encrypt staging environment (true/false).
# Set to 'true' for testing to avoid hitting rate limits on production.
# Set to 'false' only when you are ready to get production certificates.
LETSENCRYPT_STAGING=true

# --- TLS Mode C (Step-CA) Configuration ---

# Name for your Step-CA instance.
STEP_CA_NAME="Local Dev CA"

# Passwords for Step-CA (for initial bootstrap only).
# In a real environment, these would be handled via secrets management.
# For local dev, a placeholder is acceptable during bootstrap.
# IMPORTANT: These are used *only* during the `stepca-bootstrap` command.
#            They are NOT used by the running step-ca service directly.
STEP_CA_ADMIN_PROVISIONER_PASSWORD="adminpassword" # Password for the admin provisioner
STEP_CA_PASSWORD="capassword"                     # Password to encrypt the CA private key

# --- Internal Configuration (usually leave as-is) ---

# This variable is dynamically set by the Makefile based on the active profile.
# It tells Traefik which certificate resolver to use for ACME challenges.
# For Mode A (default), it's empty, relying on file-based TLS config.
# For Mode B (LE), it becomes 'le-resolver'.
# For Mode C (step-ca), it becomes 'stepca-resolver'.
TLS_CERT_RESOLVER=

# The COMPOSE_PROFILES environment variable is used by Docker Compose to activate
# specific services. It should be set when running `make up` or `make <profile>-up`.
# Example: COMPOSE_PROFILES=le
# Example: COMPOSE_PROFILES=stepca
# Example: COMPOSE_PROFILES=le,stepca (for combining profiles, though not typically needed for cert modes)
COMPOSE_PROFILES=